using System;
using System.Text.Json.Serialization;

namespace OssSecurityAgent.Models
{
    public class Vulnerability
    {
        [JsonPropertyName("packageName")]
        public string PackageName { get; set; } = string.Empty;

        [JsonPropertyName("currentVersion")]
        public string CurrentVersion { get; set; } = string.Empty;

        [JsonPropertyName("fixedVersion")]
        public string? FixedVersion { get; set; }

        [JsonPropertyName("cvssScore")]
        public double? CvssScore { get; set; }

        [JsonPropertyName("cve")]
        public string? CVE { get; set; }

        [JsonPropertyName("description")]
        public string? Description { get; set; }

        [JsonPropertyName("id")]
        public string? Id { get; set; }

        [JsonPropertyName("published")]
        public DateTime? Published { get; set; }

        [JsonPropertyName("modified")]
        public DateTime? Modified { get; set; }

        public override string ToString() =>
            $"{PackageName} v{CurrentVersion}: CVSS {CvssScore} - {CVE} - {Description}";
    }
}
